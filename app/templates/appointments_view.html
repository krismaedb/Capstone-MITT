{% extends "base_dashboard.html" %}
{% block title %}Appointment Details{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-calendar-alt"></i> Appointment #{{ appointment.id }}</h2>
    <a href="/appointments" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back</a>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5><i class="fas fa-user"></i> Patient Information</h5>
                <hr>
                <p><strong>Name:</strong> {{ appointment.patient_name }}</p>
                <p><strong>Patient ID:</strong> {{ patient.patient_id if patient else 'N/A' }}</p>
                <p><strong>Phone:</strong> {{ appointment.patient_phone or 'N/A' }}</p>
                <p><strong>Email:</strong> {{ appointment.patient_email or 'N/A' }}</p>
                {% if patient %}
                <a href="/patients/view/{{ patient.id }}" class="btn btn-sm btn-info"><i class="fas fa-eye"></i> View Full Profile</a>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5><i class="fas fa-calendar-check"></i> Appointment Details</h5>
                <hr>
                <p><strong>Date:</strong> {{ appointment.appointment_date.strftime('%Y-%m-%d') }}</p>
                <p><strong>Time:</strong> {{ appointment.appointment_time }}</p>
                <p><strong>Doctor:</strong> {{ appointment.doctor }}</p>
                <p><strong>Department:</strong> {{ appointment.department or 'N/A' }}</p>
                <p><strong>Status:</strong> <span class="badge badge-{{ appointment.status }}">{{ appointment.status|capitalize }}</span></p>
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-body">
        <h5><i class="fas fa-notes-medical"></i> Reason for Visit</h5>
        <hr>
        <p>{{ appointment.reason }}</p>
        
        {% if appointment.notes %}
        <h5 class="mt-4"><i class="fas fa-sticky-note"></i> Additional Notes</h5>
        <hr>
        <p>{{ appointment.notes }}</p>
        {% endif %}
    </div>
</div>

<!-- UPDATE STATUS -->
<div class="card">
    <div class="card-body">
        <h5><i class="fas fa-tasks"></i> Update Status</h5>
        <hr>
        <form method="POST" action="/appointments/update-status/{{ appointment.id }}" class="d-flex gap-2">
            <select name="status" class="form-control" style="max-width: 200px;">
                <option value="pending" {% if appointment.status == 'pending' %}selected{% endif %}>Pending</option>
                <option value="confirmed" {% if appointment.status == 'confirmed' %}selected{% endif %}>Confirmed</option>
                <option value="completed" {% if appointment.status == 'completed' %}selected{% endif %}>Completed</option>
                <option value="cancelled" {% if appointment.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Update Status</button>
        </form>
    </div>
</div>
{% endblock %}
